---
icon: meteor-icons:file-lines
date: 2025-11-28
category:
  - 統計検定1級
  - 統計数理
tag:
  - "2012"
  - カイ二乗分布
  - 変数変換
  - ヤコビアン
  - モーメント母関数
  - 積率母関数
  - 確率密度関数
  - ガンマ関数
  - ベータ関数

cover: "/assets/images/grade1_1/2012/thumbnail.png" 
---

<!-- more -->

# 2012年 統計数理 問2

<AffiliateBook id="kakomon1213"/>

:::info info
カイ二乗分布に関する基礎的な問題です.
積率母関数から変数変換・最大値まで完答したい問題ですね.
カイ二乗分布の詳しい解説はこちらをご覧ください！

<div class="vp-card-container">

<VPCard
  title="カイ二乗分布の性質"
  desc="期待値・分散・モーメント母関数"
  link="/posts/probability_distribution/chi2.md"
/>

</div>
:::

## [1] モーメント母関数

:::expl モーメント母関数の定義
$$
\begin{align}
M_X(t) &= \mathbb{E}[e^{tX}] \\[6pt]
\end{align}
$$
:::

:::ans

確率変数 $X$ のモーメント母関数は,
$$
\begin{align}
M_X(t) &= \mathbb{E}[e^{tX}] \\[6pt]
&= \int_0^\infty e^{tx} \frac{1}{2^{m/2}\Gamma(m/2)} x^{m/2-1}e^{-x/2}\,dx \\[6pt]
&= \int_0^\infty \frac{1}{2^{m/2}\Gamma(m/2)} x^{m/2-1}e^{-(1-2t)x/2}\,dx \\[6pt]
\end{align}
$$

$u = (1-2t)x$ とおくと,

$$
\begin{align}
M_X(t) &= \int_0^\infty \frac{1}{2^{m/2}\Gamma(m/2)} \left(\frac{u}{1-2t}\right)^{m/2-1}e^{-u/2}(1-2t)^{-1}\,du \\[6pt]
&= \int_0^\infty \frac{1}{2^{m/2}\Gamma(m/2)} (1-2t)^{-m/2}u^{m/2-1}e^{-u/2}\,du \\[6pt]
&= \frac{1}{2^{m/2}\Gamma(m/2)} (1-2t)^{-m/2} \int_0^\infty u^{m/2-1}e^{-u/2}\,du \\[6pt]
&= \frac{1}{2^{m/2}\Gamma(m/2)} (1-2t)^{-m/2}  2^{m/2}\Gamma(m/2)\\[6pt]
&= (1-2t)^{-m/2}\\[6pt]
\end{align}
$$

:::

## [2] 再生性

:::ans
確率変数 $X, Y$ が互いに独立であるとき $Z = X + Y$ のモーメント母関数は,
$$
\begin{align}
M_Z(t) &= M_X(t)M_Y(t)
\end{align}
$$
とかける. したがって

$$
\begin{align}
M_Z(t) &= (1-2t)^{-m/2}(1-2t)^{-n/2} \\[6pt]
&= (1-2t)^{-\frac{m+2}{2}}
\end{align}
$$

これは自由度 $m+n$ のカイ二乗分布のモーメント母関数と一致するので, $Z$ は自由度 $m+n$ のカイ二乗分布である.
:::

## [3] 変数変換
:::plan
1. 逆変換を求める
2. ヤコビアンを計算する
3. 同時確率密度関数 $f(w,z)=f(x, y)|J|$ を計算する
4. $z$ で周辺化して $f(w)$ を求める. $f(w) = \int_0^{\infty} f(w, z)\,dz$
:::

:::ans
$z = x + y, w = \frac{x}{x+y}$ で変数変換すると.

- 逆変換
  $$
  \begin{align}
  x = wz,\quad y = z(1-w) 
  \end{align}
  $$

- ヤコビアン$|J|$
  
  $$
  \begin{align}
  |J|
  &=
  \left|
  \begin{matrix}
  \dfrac{\partial x}{\partial w} & \dfrac{\partial x}{\partial z} \\
  \dfrac{\partial y}{\partial w} & \dfrac{\partial y}{\partial z}
  \end{matrix}
  \right| \\[6pt]
  &= 
  \left|
  \begin{matrix}
  z & w \\
  -z & 1-w
  \end{matrix}
  \right| \\[6pt]
  &= z

  \end{align}
  $$

したがって $(W, Z)$ の同時確率密度関数は,

$$
\begin{align}
f(w, z) &= f(x, y)|J| \\[6pt]
&= f_X(x)f_Y(y)|J| \\[6pt]
&= f_X(wz)f_Y(z(1-w))|J| \\[6pt]
\end{align}
$$

ここで $f_X(wz), f_Y(z(1-w))$ は,

$$
\begin{align}
f_X(wz) &= \frac{1}{2^{m/2}\Gamma(m/2)} (wz)^{m/2-1}e^{-wz/2} \\[6pt]
f_Y(z(1-w)) &= \frac{1}{2^{n/2}\Gamma(m/2)} \{z(1-w)\}^{n/2-1}e^{-z(1-w)/2} \\[6pt]
\end{align}
$$

したがって,

$$
\begin{align}
f(w, z) &= \frac{1}{2^{m/2}\Gamma(m/2)} (wz)^{m/2-1}e^{-wz/2}\frac{1}{2^{n/2}\Gamma(m/2)} \{z(1-w)\}^{n/2-1}e^{-z(1-w)/2} z \\[6pt]
&= \frac{1}{2^{\tfrac{m+2}{2}\Gamma(m/2)\Gamma(n/2)}}w^{\tfrac{m}{2}-1}(1-w)^{\tfrac{n}{2}-1}z^{\tfrac{m+n}{2}-1}e^{-z/2}
\end{align}
$$

$z$ で周辺化すると,

$$
\begin{align}
f_W(w) &= \int_0^\infty\frac{1}{2^{\tfrac{m+2}{2}\Gamma(m/2)\Gamma(n/2)}}w^{\tfrac{m}{2}-1}(1-w)^{\tfrac{n}{2}-1}z^{\tfrac{m+n}{2}-1}e^{-z/2} \,dz \\[6pt]
&= \frac{w^{\tfrac{m}{2}-1}(1-w)^{\tfrac{n}{2}-1}}{2^{\tfrac{m+2}{2}\Gamma(m/2)\Gamma(n/2)}}\int_0^\infty z^{\tfrac{m+n}{2}-1}e^{-z/2} \,dz \\[6pt]
&= \frac{w^{\tfrac{m}{2}-1}(1-w)^{\tfrac{n}{2}-1}}{2^{\tfrac{m+2}{2}\Gamma(m/2)\Gamma(n/2)}}2^{\tfrac{m+2}{2}\Gamma(\tfrac{m+n}{2})} \\[6pt]
&= \frac{w^{\tfrac{m}{2}-1}(1-w)^{\tfrac{n}{2}-1}}{\Gamma(m/2)\Gamma(n/2)}\Gamma(\tfrac{m+n}{2}) \\[6pt]
&= \frac{\Gamma(\tfrac{m+n}{2})}{\Gamma(m/2)\Gamma(n/2)}w^{\tfrac{m}{2}-1}(1-w)^{\tfrac{n}{2}-1} \\[6pt]
&= \frac{1}{\mathrm{B}(m/2, n/2)}w^{\tfrac{m}{2}-1}(1-w)^{\tfrac{n}{2}-1} \quad \left(\therefore\mathrm{B}(m/2, n/2) = \frac{\Gamma(m/2)\Gamma(n/2)}{\Gamma(\frac{m+n}{2})}\right)\\[6pt]
\end{align}
$$
これはパラメータ $(m/2, n/2)$ のベータ分布である.

:::

## [4] 最大値
:::plan
$$
\begin{align}
f_W(w) &= \frac{1}{\mathrm{B}(m/2, n/2)}w^{\tfrac{m}{2}-1}(1-w)^{\tfrac{n}{2}-1} \\[6pt]
\frac{d}{dw}f_W(w) &= \frac{d}{dw}\frac{1}{\mathrm{B}(m/2, n/2)}w^{\tfrac{m}{2}-1}(1-w)^{\tfrac{n}{2}-1} = 0 \\[6pt]
\end{align}
$$
最大値をとる $w$ は微分して $0$ とおけば求められます。
:::
:::ans
$a = \frac{m}{2}-1$, $b = \frac{n}{2}-1$ とおくと,
$$
\begin{align}
\frac{d}{dw}w^{a}(1-w)^{b} &= 0 \\[6pt]
aw^{a-1}(1-w)^b - bw^a(1-b)^{b-1} &= 0 \\[6pt]
w^{a-1}(1-w)^{b-1}\set{a-(a+b)w} &= 0 \\[6pt]
w = 0\;,\; 1\;,\; &\frac{a}{a+b} \\[6pt]
w = 0\;,\; 1\;,\; &\frac{m-2}{m+n-4}
\end{align}
$$

<br> 

ここで$f_W(0)=f_W(1)=0,\; f_W(\frac{m-2}{m+n-4})>0$　より $\frac{m-2}{m+n-4}$ が最大値をとる
:::

## 参考文献
<AffiliateBook id="kakomon1213"/>
<AffiliateBook id="official1"/>
<AffiliateBook id="takemura_gen_stats"/>