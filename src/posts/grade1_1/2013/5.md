---
icon: meteor-icons:file-lines
date: 2025-09-30
category:
  - 統計検定1級
  - 統計数理
  - 仮説検定
tag:
  - "2013"
  - 多項分布
  - 二項分布
  - 尤度比検定
  - 適合度のカイ二乗検定
  - 正規近似
  - 漸近分布
  - ラグランジュの未定乗数法

cover: "/assets/images/grade1_1/2013/thumbnail.png" 
---

<!-- more -->

# 2013年 統計数理 問5

<AffiliateBook id="kakomon1213"/>

:::expl
- 母集団: 多項分布 $\mathrm{Multinomial}(n;\,\theta_1,\dots,\theta_m)$
- パラメータ: $n \in \mathbb{N}_{>0}$, $\theta_i \ge 0$, $\sum_{i=1}^m \theta_i = 1$
- 変数: 離散型 $X_1,\dots,X_m$ で $\sum_{i=1}^m X_i = n$
- 観測値: 1組のデータ $\{x_1,\dots,x_m\}$ を観測
- 観測値の制約: $x_i \in \{0,1,\dots,n\}$, $\sum_{i=1}^m x_i = n$


[1] この観測地に基づいた尤度関数を求めよ

[2] $\theta_{10}, \dots \theta_{m0}$ を与えられたパラメータ値とし、
帰無仮説 $H_0:\theta_1 = \theta_{10}, \dots \theta_m = \theta_{m0}$ を検定する. このとき、

- (a) 尤度比検定統計量と、その帰無仮説の下での漸近分布を示せ.
- (b) 適合度のカイ二乗検定統計量と, その帰無仮説の下での漸近分布を示せ.

[3] 確率変数 $X$ がパラメータ $n$ および　$p$ の二項分布 $B(n, p)$に従うとする. $p_0$ をある与えられた値としたとき, 
$X$ の正規近似による, 帰無仮説 $H_0: p = p_0$ の両側検定は上問[2]の(b)における $m=2$ の場合の帰無仮説 $H_0: \theta_1 = p_0, \theta_2 = 1 - p_0$ の検定と一致することを示せ.

[4] 上問[2]における(a)および(b)の検定法は, 漸近的に同等であることを示せ.
:::

## [1] 尤度関数
:::expl
多項分布の尤度関数を求める問題です.
ここではただ尤度関数を提示するだけですが[2]以降のため、最尤推定量まで求めます.

多項分布の最尤推定量の導出には ==ラグランジュの未定乗数法== を利用します.
:::

:::ans
多項分布の尤度関数 $L(\theta_1, \dots, \theta_m)$ は
$$
L(\theta_1, \dots, \theta_m) = \frac{n!}{x_1!x_2!\dots x_m!}\theta_1^{x_1}\theta_2^{x_2}\dots\theta_m^{x_m}
$$

対数尤度関数は
$$
\begin{align}
\log{L(\theta_1, \dots, \theta_m)} &= \log{\frac{n!}{x_1!x_2!\dots x_m!}\theta_1^{x_1}\theta_2^{x_2}\dots\theta_m^{x_m}} \\[6pt]
&= \log{\frac{n!}{x_1!x_2!\dots x_m!}} + \sum_{i=1}^m \log{\theta_i^{x_i}} \\[6pt]
&= \log{\frac{n!}{x_1!x_2!\dots x_m!}} + \sum_{i=1}^m x_i\log{\theta_i}
\end{align}
$$
:::

::: ans 最尤推定量
多項分布の最尤推定量はラグランジュの未定乗数法を利用して
$$
\begin{align}
\hat \theta_i = \frac{x_i}{n}
\end{align}
$$
で表せる. 詳しくはこちらの記事を参照ください.

<div class="vp-card-container">
<VPCard
  title="多項分布の最尤推定量"
  desc="最尤推定量・ラグランジュの未定乗数法"
  link="/posts/probability_distribution/multinomial_likelihood.html"
/>
</div>
:::

## [2] 尤度比検定・適合度のカイ二乗検定

### (a) 尤度比検定
==**尤度比検定についてはこちらを参照ください**==
<div class="vp-card-container">
<VPCard
  title="尤度比検定"
  desc="尤度比検定の概要"
  link="/posts/test/likelihood_ratio.html"
/>
</div>

:::ans
帰無仮説と対立仮説は
$$
\begin{align}
H_0 &: \boldsymbol \theta = \boldsymbol \theta_0 =  \left(\theta_{10}, \theta_{20}, \dots, \theta_{m0}\right) \\[6pt]
H_1 &: \boldsymbol \theta \neq \boldsymbol \theta_0
\end{align}
$$
最尤推定量は $\hat \theta_i = \frac{x_i}{n} \quad (i=1,2,\dots ,m)$ で与えられるので,
$$
\begin{align}
\hat{\boldsymbol{\theta}} = \left(\frac{x_1}{n}, \frac{x_2}{n}, \dots, \frac{x_m}{n}\right)
\end{align}
$$
とすると, 尤度比 $\Lambda$ は,
$$
\begin{align}
\Lambda &= \frac{L(\boldsymbol{\theta}|H_0)}{L(\boldsymbol{\theta}|H_1)} \\[6pt]
&= \frac{L(\boldsymbol{\theta_0})}{L(\hat{\boldsymbol{\theta}})} \\[6pt]
&= \frac{\tfrac{n!}{x_1!\dots x_m!}\prod_{i=1}^m \theta_{i0}^{x_i}}{\tfrac{n!}{x_1!\dots x_m!}\prod_{i=1}^m \hat\theta_i^{x_i}} \\[6pt]
&= \prod_{i=1}^m \left(\frac{\theta_{i0}}{\hat\theta_i}\right)^{x_i} \\[6pt]
\end{align}
$$

よって尤度比検定統計量 $D=-2\log\Lambda$ は,
$$
\begin{align}
D &= -2 \log \prod_{i=1}^m \left(\frac{\theta_{i0}}{\hat\theta_i}\right)^{x_i}  \\[6pt]
&= -2 \sum_{i=1}^m x_i \log \frac{\theta_{i0}}{\hat\theta_i} \\[6pt]
&= -2 \sum_{i=1}^m x_i \log \frac{n\theta_{i0}}{x_i} \\[6pt]
&= 2 \sum_{i=1}^m x_i \log \frac{x_i}{n\theta_{i0}} \\[6pt]
\end{align}
$$

$D$ は帰無仮説下で標本数が十分に大きいときWilksの定理より自由度 $m-1$ のカイ二乗分布に従う.

:::

### (b) 適合度のカイ二乗検定
:::expl
- 理論確率(帰無仮説の確率): $\theta_{i0}$
- 期待度数: $n\theta_{i0}$
- 観測度数: $x_i$
:::

:::ans
検定統計量を $T$ とすると,
$$
\begin{align}
T = \sum_{i=1}^m \frac{(x_i - n\theta_{i0})^2}{n\theta_{i0}}
\end{align}
$$

また $T$ は標本数が十分に大きいとき自由度 $m-1$ のカイ二乗分布に従う.
:::

## [3]　二項分布の正規近似と適合度のカイ二乗分布の同等性
二項分布についてはこちらの記事をご参照ください.
<div class="vp-card-container">
<VPCard
  title="二項分布"
  desc="期待値・分散"
  link="/posts/probability_distribution/binomial.md"
/>
</div>

:::ans
確率変数 $X$ が二項分布に従うとき, 正規近似した確率変数を $Z$ とすると,
$$
\begin{align}
Z &= \frac{X-np}{\sqrt{np(1-p)}} \sim \mathcal{N}(0, 1)
\end{align}
$$

帰無仮説 $H_0: p=p_0$ のもとで, 統計量$Z^2$ は,

$$
\begin{align}
Z &= \frac{X-np_0}{\sqrt{np_0(1-p_0)}} \\[6pt]
&= \frac{(X-np_0)^2}{np_0(1-p_0)} 
\end{align}
$$

また $Z \sim \mathcal{N}(0, 1)$ より $Z^2 \sim \chi2(1)$

一方, [2]-(b)で
- $m=2$
- $\theta_1 = p_0, \theta_2 = 1 - p_0$
- $X_1 + X_2 = n$ , (ただし $X = X_1$ )

のとき, 統計量 $T$ に代入すると,
$$
\begin{align}
T &= \sum_{i=1}^2 \frac{(X_i - n\theta_{i0})^2}{n\theta_{i}} \\[6pt]
&= \frac{(X_1 - n\theta_{1})^2}{n\theta_{1}} + \frac{(X_2 - n\theta_{2})^2}{n\theta_{2}} \\[6pt]
&= \frac{(X_1 - np_0)^2}{np_0} + \frac{(n-X_1 - n(1-p_0))^2}{n(1-p_0)} \\[6pt]
&= \frac{(X_1 - np_0)^2}{np_0} + \frac{(X_1 - np_0)^2}{n(1-p_0)} \\[6pt]
&= \frac{(X_1 - np_0)^2}{np_0} + \frac{(X_1 - np_0)^2}{n(1-p_0)} \\[6pt]
&= \frac{(X_1-np_0)^2}{np_0(1-p_0)} 
\end{align}
$$
また $T \sim \chi2(1)$　であるから $m=2$ のとき
二項分布の正規近似したカイ二乗検定統計量と適合度のカイ二乗検定統計量は一致する
:::

## [4] 尤度比検定と適合度のカイ二乗検定の漸近同等性
執筆中...

## 参考文献
<AffiliateBook id="kakomon1213"/>
<AffiliateBook id="official1"/>
<AffiliateBook id="takemura_gen_stats"/>