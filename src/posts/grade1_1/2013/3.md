---
icon: meteor-icons:file-lines
date: 2025-09-25
category:
  - 統計検定1級
  - 統計数理
tag:
  - "2013"
  - 二項分布
  - 不偏推定量
  - 最尤推定量
  - 被覆確率
  - 信頼区間
---

# 2013年 統計数理 問3

<div style="display: flex; gap: 10px; justify-content: center;">
  <img src="/assets/images/grade1_1/2013/thumbnail.png" style="max-width: 100%; height: auto;">
</div>

<AffiliateBook id="kakomon1213"/>


:::expl
二項分布の基本的な性質を問われる問題です.
期待値, 分散, 不偏推定量, 最尤推定量([1]~[3])は完璧に導出できるようにしたいです.
:::

## [1] 期待値と分散

::: expl 二項分布の期待値と分散
[二項分布](/posts/probability_distribution/binomial.md)の記事をご覧ください.
:::

## [2] 最尤推定量と不偏推定量

$\hat{p} = \dfrac{X}{n}$ が最尤推定量かつ不偏推定量であることを示す.

### 最尤推定量
::: ans
$X \sim \mathrm{Binomial}(n,p)$ の尤度は
$$
L(p;X)=\,{}_nC_x\, p^{x}(1-p)^{\,n-x}\quad(0\le p\le 1)
$$
対数尤度は
$$
\begin{align}
\ell(p) 
  &= \log L \\[6pt]
  &= \log({}_nC_x) 
     + x\log p 
     + (n-x)\log(1-p)
\end{align}
$$

微分してゼロに置く:
$$
\ell'(p)=\frac{x}{p}-\frac{n-x}{1-p}=0
\ \Rightarrow\ 
\hat{p}=\frac{x}{n}
$$

したがって $\hat{p} = \dfrac{X}{n}$ は最尤推定量である.
:::

### 不偏推定量
::: ans
$$
\begin{align}
\mathbb{E}[\tfrac{X}{n}]
&=\tfrac{1}{n}\mathbb{E}[X] \\[6pt]
&=\frac{1}{n}\,np \\[6pt]
&= p
\end{align}
$$
したがって $\hat{p}=X/n$ は不偏推定量である.
:::

### 分散の不変推定量

:::ans
$\hat{p}$ の分散 $w_n(p)$ は,

$$
\begin{align}
w_n(p) &= \mathrm{V}[\hat{p}] \\[6pt]
&= \mathrm{V}[\tfrac{X}{n}] \\[6pt]
&= \frac{1}{n^2} \mathrm{V}[X] \\[6pt]
&= \frac{1}{n^2} np(1-p) \\[6pt]
&= \frac{p(1-p)}{n} \\[6pt]
\end{align}
$$

$w_n(p)$ 推定量 $\hat{w_n} = w_n(\hat{p})$ より,

$$
\begin{align}
w_n(\hat{p}) &= \frac{\hat{p}(1-\hat{p})}{n} \\[6pt]
\end{align}
$$

推定量 $\hat{w}_n = w_n(\hat{p})$ が不偏推定量でないことを確認する.
$$
\begin{align}
\mathbb{E}[w_n(\hat{p})] &= \mathbb{E}\left[\tfrac{\hat{p}(1-\hat{p})}{n}\right] \\[6pt]
&= \frac{1}{n} \mathbb{E}\left[\tfrac{X}{n}(1-\tfrac{X}{n})\right] \\[6pt]
&= \frac{1}{n} \mathbb{E}\left[\tfrac{X}{n}-\tfrac{X^2}{n^2}\right] \\[6pt]
&= \frac{1}{n^2} \mathbb{E}[X-\tfrac{X^2}{n}] \\[6pt]
&= \frac{1}{n^2} \left(\mathbb{E}[X]-\tfrac{1}{n}\mathbb{E}[X^2] \right)\\[6pt]
\end{align}
$$

ここで期待値と二次モーメントより([二項分布の性質](/posts/probability_distribution/binomial.html#_4-分散))
$$
\begin{align}
\mathbb{E}[X]&=np \\[6pt]
\mathbb{E}[X^2] &= n(n-1)p^2 + np
\end{align}
$$

より
$$
\begin{align}
\mathbb{E}[w_n(\hat{p})] &= \frac{1}{n^2} \left(\mathbb{E}[X]-\tfrac{1}{n}\mathbb{E}[X^2] \right)\\[6pt]
&= \frac{1}{n^2} \left(np-\frac{1}{n}(n(n-1)p^2 + np) \right)\\[6pt]
&= \frac{1}{n^2} \left(np-(n-1)p^2 - p \right)\\[6pt]
&= \frac{1}{n^2} (np-np^2 +p^2 - p )\\[6pt]
&= \frac{(n-1)p(1-p)}{n^2}\\[6pt]
&= \frac{n-1}{n} \times \frac{p(1-p)}{n}  \\[6pt]
&= \frac{n-1}{n} w_n(p)  \\[6pt]

\end{align}
$$

したがって $w_n(\hat{p})$ は不偏推定量ではない.

また上式から

$\mathbb{E}[\frac{n}{n-1}w_n(\hat{p})]$ は不偏推定量となるので

$$
\tilde{w}_n = c(n)\hat{w}_n
$$
を満たす $c(n)$ は

$$
c(n) = \frac{n}{n-1}
$$
:::

### [4] 被覆確率
正規近似のWald区間で比較する.  

$\hat w_n$ 信頼区間の大きさ $|CI(\hat w_n)|$ は,
$$
\begin{align}
|CI(\hat w_n)| &= (\hat p + 1.96 \sqrt{\hat w_n}) - (\hat p - 1.96 \sqrt{\hat w_n}) \\[6pt]
&= 2 \times 1.96 \sqrt{\hat w_n} \\[6pt]
\end{align}
$$

$\tilde w_n$ 信頼区間の長さ $|CI(\tilde w_n)|$ は,
$$
\begin{align}
|CI(\tilde w_n)| &= (\hat p + 1.96 \sqrt{\tilde w_n}) - (\hat p - 1.96 \sqrt{\tilde w_n}) \\[6pt]
&= 2 \times 1.96 \sqrt{\tilde w_n} \\[6pt]
&= 2 \times 1.96 \sqrt{\tfrac{n}{n-1}} \sqrt{\hat w_n} \\[6pt]
\end{align}
$$


この二つの区間を比べると
$$
|CI(\tilde w_n)| > |CI(\hat w_n)|
$$
であることが分かる.

::: expl 信頼区間と被覆確率
**信頼区間**とは，データ $X$ から区間推定量 $CI(X)$ を構成し，同じ手順を多数回繰り返すと，真のパラメータ $\theta$ がその区間に含まれる割合が信頼係数 $1-\alpha$ になるよう設計された区間のことを指す.

==例えば, 信頼係数を95%で構成するとき, 100回実験をすれば95回は信頼区間にパラメータ $\theta$ が含まれているということです.==

**被覆確率**とは，真の値 $\theta$ の下で区間が $\theta$ を含む確率
$$
\mathrm{Coverage}(\theta)=\mathbb{P}_\theta \bigl(\theta\in CI(X)\bigr)
$$
のこと. 理想的には $\mathrm{Coverage}(\theta)=1-\alpha$ だが，有限標本や近端領域では
$$
\mathrm{Coverage}(\theta)\neq 1-\alpha
$$
となる場合があるため，実際の被覆（実被覆）をシミュレーション等で評価するのが実務的です.

:::

::: hint シミュレーション
赤が補正前の推定量 $\hat w_n$, 青が補正後の推定量 $\tilde w_n$ です.
グラフから, 青の線の方が名目 $0.95$（信頼係数 $95\%$）に近いことが分かります.

また, ==$p=0,1$ 付近では被覆確率が極端に低下==し, ==標本数が小さいと $p$ 全域で $95\%$ を下回る==ことが確認できます.

<div style="display: flex; gap: 10px; justify-content: center;">
  <img src="/assets/images/grade1_1/2013/wald_coverage_n.gif" style="max-width: 100%; height: auto;">
</div>
:::

::: sum
- 離散母数問題でのWald区間は, 被覆確率を名目値に一致させるには十分な標本数が必要となる.
- 実務では Wilson や Clopper–Pearson の**正確区間**などの代替や補正を検討する.
:::
