---
icon: meteor-icons:file-lines
date: 2025-09-24
category:
  - 統計検定1級
  - 統計数理
tag:
  - "2013"
  - 正規分布
  - 多変量正規分布
  - 条件付き分布
  - 独立
---

# 2013年 統計数理 問2

<div style="display: flex; gap: 10px; justify-content: center;">
  <img src="/assets/images/grade1_1/2013/thumbnail.png" style="max-width: 100%; height: auto;">
</div>

::: expl
正規分布の以下の性質を問う問題です。
- 独立性と無相関性
- 条件付き分布
- 再生性
:::

## [1] 独立性の証明

::: plan
正規分布では独立性と無相関性は同値なので、以下の式を満たすことを示す.
$$
\mathrm{Cov}[Y_n, X_1-\tfrac{Y_n}{n}] = 0
$$
:::

::: ans
共分散の線形性より,

$$
\begin{align}
\mathrm{Cov}[Y_n, X_1-\tfrac{Y_n}{n}] 
&= \mathrm{Cov}[Y_n, X_1] + \mathrm{Cov}[Y_n, -\tfrac{Y_n}{n}] \\[6pt]
&= \mathrm{Cov}[Y_n, X_1] - \tfrac{1}{n}\mathrm{V}[Y_n]
\end{align}
$$

ここで,
$$
Y_n = \sum_{i=1}^n X_i
$$

だから,

$$
\mathrm{Cov}[Y_n, X_1] 
= \mathrm{Cov}\!\left[\sum_{i=1}^n X_i,\, X_1\right]
$$

[共分散は線形性](/posts/multivariate_distribution/covariance.md)を持つので,

$$
\mathrm{Cov}[Y_n, X_1] 
= \sum_{i=1}^n \mathrm{Cov}[X_i, X_1]
$$

ここで $\{X_i\}$ は独立同分布 $N(\mu,\sigma^2)$ に従う.  
したがって

- $i=1$ のとき:  
  $$
  \mathrm{Cov}[X_1, X_1] = \mathrm{V}[X_1] = \sigma^2
  $$

- $i \neq 1$ のとき独立だから:
  $$
  \mathrm{Cov}[X_i, X_1] = 0
  $$

よって,

$$
\mathrm{Cov}[Y_n, X_1] = \sigma^2 + \sum_{i=2}^n 0 = \sigma^2
$$

また,

$$
\mathrm{V}[Y_n] = \sum_{i=1}^n \mathrm{V}[X_i] = n\sigma^2
$$

よって,

$$
\begin{align}
\mathrm{Cov}[Y_n, X_1-\tfrac{Y_n}{n}] 
&= \sigma^2 - \tfrac{1}{n}(n\sigma^2) \\[6pt]
&= \sigma^2 - \sigma^2 \\[6pt]
&= 0
\end{align}
$$

したがって
$$
Y_n \;\perp\!\!\!\perp\; X_1-\tfrac{Y_n}{n}
$$
が成り立つ.
:::

## [2] 条件付き分布 $X_1|Y_n$
::: plan
1. $(X_1, Y_n)$ は 2 次元正規分布に従う.  

2. $X_1|Y_n$ は正規分布に従う.

3. [1]の独立性を利用して期待値と分散を求める.

$X_1, Y_n$ はそれぞれ正規分布に従うため、条件付き分布 $X_1|Y_n$ は正規分布に従う.
:::


::: calc 期待値

$$
\begin{align}
\mathbb{E}[X_1|Y_n] &= \mathbb{E}[\{X_1 - \tfrac{Y_n}{n} + \tfrac{Y_n}{n}\}|Y_n] \\[6pt]
&= \mathbb{E}[\{X_1 - \tfrac{Y_n}{n}\}|Y_n] + \mathbb{E}[\tfrac{Y_n}{n}|Y_n] \\[6pt] 
&= \mathbb{E}[\{X_1 - \tfrac{Y_n}{n}\}|Y_n] + \mathbb{E}[\tfrac{Y_n}{n}|Y_n] \\[6pt] 
\end{align}
$$


$Y_n \;\perp\!\!\!\perp\; X_1-\tfrac{Y_n}{n}$ より、1項目は無条件で考えられるので

$$
\begin{align}
\mathbb{E}[\{X_1 - \tfrac{Y_n}{n}\}|Y_n] &= \mathbb{E}[X_1 - \tfrac{Y_n}{n}] \\[6pt]
&= \mathbb{E}[X_1] - \tfrac{1}{n}\mathbb{E}[Y_n] \\[6pt]
&= \mu - \frac{n\mu}{n} = 0
\end{align}
$$

したがって期待値は,

$$
\begin{align}
\mathbb{E}[X_1|Y_n] &= \mathbb{E}[\{X_1 - \tfrac{Y_n}{n}\}|Y_n] + \mathbb{E}[\tfrac{Y_n}{n}|Y_n] \\[6pt] 
&= 0 + \mathbb{E}[\tfrac{y_n}{n}] \\[6pt]
&= \frac{y_n}{n} 
\end{align}
$$
:::

::: calc 分散
次に分散を計算する.  

$$
\begin{align}
\mathrm{V}[X_1 \mid Y_n] 
&= \mathrm{V}\!\left[\left(X_1-\tfrac{Y_n}{n}\right) + \tfrac{Y_n}{n}\;\middle|\;Y_n\right] \\[6pt]
&= \mathrm{V}[X_1-\tfrac{Y_n}{n}\mid Y_n]
\end{align}
$$

ここで再び独立性を用いると

$$
\mathrm{V}[X_1-\tfrac{Y_n}{n}\mid Y_n] 
= \mathrm{V}[X_1-\tfrac{Y_n}{n}]
$$

したがって

$$
\begin{align}
\mathrm{V}[X_1-\tfrac{Y_n}{n}] 
&= \mathrm{V}[X_1] + \frac{1}{n^2}\mathrm{V}[Y_n] - \frac{2}{n}\mathrm{Cov}[X_1,Y_n] \\[6pt]
&= \sigma^2 + \frac{1}{n^2}(n\sigma^2) - \frac{2}{n}\sigma^2 \\[6pt]
&= \sigma^2 + \frac{\sigma^2}{n} - \frac{2\sigma^2}{n} \\[6pt]
&= \sigma^2 - \frac{\sigma^2}{n} \\[6pt]
&= (1-\tfrac{1}{n})\sigma^2
\end{align}
$$
:::

::: sum 結論

$$
X_1 \mid Y_n \sim \mathcal{N}\!\left(\tfrac{y}{n},\, (1-\tfrac{1}{n})\sigma^2\right)
$$

:::

### 別解
::: details 一般的な公式から導出

  ::: plan
  1. $(X_1, Y_n)$ は 2 次元正規分布に従う.  
  2. $X_1|Y_n$ は正規分布に従う.
  3. $X_1|Y_n$ の分布は、[2次元正規分布の条件付き分布](/posts/multivariate_distribution/normal_cpd.md)の公式を用いて求められる.
  :::

  :::def 2次元正規分布の条件付き分布
  まず一般の公式を確認する.  

  $$
  (X,Y) \sim \mathcal{N}\!\left(
  \begin{pmatrix}\mu_X \\ \mu_Y\end{pmatrix},
  \begin{pmatrix}
  \sigma_X^2 & \rho \sigma_X\sigma_Y \\
  \rho \sigma_X\sigma_Y & \sigma_Y^2
  \end{pmatrix}
  \right)
  $$

  のとき、条件付き分布は  

  $$
  X \mid Y=y \sim \mathcal{N}\!\left(
  \mu_X + \rho \frac{\sigma_X}{\sigma_Y}(y-\mu_Y),\,
  (1-\rho^2)\sigma_X^2
  \right)
  $$

  で与えられる.  
  :::


::: calc
ここで $X=X_1$, $Y=Y_n$ とすると、  

- $\mu_X = \mu$

- $\mu_Y = n\mu$  

- $\sigma_X^2 = \sigma^2$  

- $\sigma_Y^2 = n\sigma^2$

- $\rho = \frac{\mathrm{Cov}[X_1,Y_n]}{\sigma_X\sigma_Y} = \frac{\sigma^2}{\sigma \cdot \sqrt{n\sigma^2}} = \frac{1}{\sqrt{n}}$

を得る.  

したがって  

$$
\begin{align}
\mathbb{E}[X_1 \mid Y_n=y_n] 
&= \mu + \frac{1}{\sqrt{n}} \cdot \frac{\sigma}{\sqrt{n\sigma^2}}(y_n-n\mu) \\[6pt]
&= \mu + \frac{1}{n}(y_n-n\mu) \\[6pt]
&= \tfrac{y_n}{n},
\end{align}
$$

$$
\mathrm{V}[X_1 \mid Y_n] 
= (1-\tfrac{1}{n})\sigma^2
$$

$$
X_1 \mid Y_n \sim \mathcal{N}\!\left(\tfrac{y}{n},\, (1-\tfrac{1}{n})\sigma^2\right)
$$
:::

## [3] 条件付き分布 $Y_{k-1}\mid Y_k$

::: plan
1. $(Y_{k-1}, Y_k)$ は 2 次元正規分布に従う.  
2. よって $Y_{k-1}\mid Y_k$ は正規分布に従う.  
3. [2] と同様に、期待値と分散を計算する.  

[2] で得た結果を任意の $k\,(1\leq k\leq n)$ に拡張すると

$$
X_k \mid Y_k \sim \mathcal{N}\!\left(\tfrac{y_k}{k},\,(1-\tfrac{1}{k})\sigma^2\right)
$$

である.  

ここで $Y_{k-1} = Y_k - X_k$ である.  
:::

::: calc 期待値

$$
\begin{align}
\mathbb{E}[Y_{k-1}\mid Y_k] 
&= \mathbb{E}[Y_k - X_k \mid Y_k] \\[6pt]
&= \mathbb{E}[Y_k\mid Y_k] - \mathbb{E}[X_k\mid Y_k] \\[6pt]
&= y_k - \tfrac{y_k}{k} \\[6pt]
&= \left(1-\tfrac{1}{k}\right)y_k
\end{align}
$$
:::

::: calc 分散

$$
\begin{align}
\mathrm{V}[Y_{k-1}\mid Y_k] 
&= \mathrm{V}[Y_k - X_k \mid Y_k] \\[6pt]
&= \mathrm{V}[Y_k \mid Y_k] + \mathrm{V}[X_k \mid Y_k] - 2\,\mathrm{Cov}[Y_k, X_k \mid Y_k]
\end{align}
$$

ここで $Y_k$ は条件付きで定数となるため

$$
\mathrm{V}[Y_k \mid Y_k] = 0
$$

また、定数との共分散は 0 なので
$$
\mathrm{Cov}[Y_k, X_k \mid Y_k] = 0
$$

したがって

$$
\mathrm{V}[Y_{k-1}\mid Y_k] 
= \mathrm{V}[X_k \mid Y_k] 
= \left(1-\tfrac{1}{k}\right)\sigma^2
$$

:::

::: sum 結論

$$
Y_{k-1}\mid Y_k \;\sim\; \mathcal{N}\!\left(\left(1-\tfrac{1}{k}\right)y_k,\,\left(1-\tfrac{1}{k}\right)\sigma^2\right)
$$
:::

### 別解
::: details 一般的な公式から導出

  ::: def 公式
  2次元正規分布の一般公式を相関係数の形で用いる.  

  $$
  \begin{pmatrix}U \\ V\end{pmatrix}
  \sim \mathcal{N}\!\left(
  \begin{pmatrix}\mu_U \\ \mu_V\end{pmatrix},
  \begin{pmatrix}
  \sigma_U^2 & \rho \sigma_U \sigma_V \\
  \rho \sigma_U \sigma_V & \sigma_V^2
  \end{pmatrix}
  \right)
  $$

  のとき，

  $$
  U \mid V=v \;\sim\; 
  \mathcal{N}\!\left(
  \mu_U + \rho \frac{\sigma_U}{\sigma_V}(v-\mu_V),\,(1-\rho^2)\sigma_U^2
  \right)
  $$

  である.  
  :::

  ::: calc
  ここで $U=Y_{k-1},\; V=Y_k$ とする.  

  - $\mathbb{E}[Y_{k-1}] = (k-1)\mu$  

  - $\mathbb{E}[Y_k] = k\mu$  

  - $\mathrm{V}[Y_{k-1}] = (k-1)\sigma^2 \;\;\Rightarrow\;\; \sigma_{Y_{k-1}} = \sqrt{k-1}\,\sigma$  

  - $\mathrm{V}[Y_k] = k\sigma^2 \;\;\Rightarrow\;\; \sigma_{Y_k} = \sqrt{k}\,\sigma$  

  - $\mathrm{Cov}[Y_{k-1},Y_k] = (k-1)\sigma^2$  

  したがって相関係数は  

  $$
  \rho = \frac{\mathrm{Cov}[Y_{k-1},Y_k]}{\sigma_{Y_{k-1}}\sigma_{Y_k}}
  = \frac{(k-1)\sigma^2}{\sqrt{k-1}\,\sigma \cdot \sqrt{k}\,\sigma}
  = \sqrt{\tfrac{k-1}{k}}
  $$

  ---

  このとき条件付き分布は  

  $$
  Y_{k-1}\mid Y_k=y_k \;\sim\; 
  \mathcal{N}\!\left(
  (k-1)\mu + \rho \frac{\sigma_{Y_{k-1}}}{\sigma_{Y_k}}(y_k-k\mu),\,
  (1-\rho^2)\sigma_{Y_{k-1}}^2
  \right)
  $$

  ここに値を代入すると  

  - 期待値:
  $$
  (k-1)\mu + \sqrt{\tfrac{k-1}{k}} \cdot \frac{\sqrt{k-1}\sigma}{\sqrt{k}\sigma}(y_k-k\mu) \\[6pt]
  = (k-1)\mu + \tfrac{k-1}{k}(y_k-k\mu) \\[6pt]
  = \left(1-\tfrac{1}{k}\right)y_k
  $$

  - 分散:
  $$
  (1-\tfrac{k-1}{k})(k-1)\sigma^2
  = \tfrac{1}{k}(k-1)\sigma^2
  = \left(1-\tfrac{1}{k}\right)\sigma^2
  $$
  :::

  ::: sum 結論
  $$
  Y_{k-1}\mid Y_k=y_k \;\sim\; 
  \mathcal{N}\!\left(\left(1-\tfrac{1}{k}\right)y_k,\,\left(1-\tfrac{1}{k}\right)\sigma^2\right)
  $$
  :::

:::

## [4]
::: plan
1. 同時確率密度関数 $f(y_1, \dots, y_n)$ を求める
2. $f(y_1, \dots, y_n) \to f(x_1, \dots, x_n)$ の変数変換を考える
:::

### 連鎖率の計算
::: plan 与えられた式
$$
\left\{ \prod_{k=2}^n f_{k-1}(y_{k-1}|y_k) \right\} \times g_n(y_n)
$$

さて、この式はどのような関数になるだろうか。まず考えたいのが==条件付き確率の連鎖率の形==である。
:::

::: def 条件付き確率密度関数の連鎖率
一般に条件付き確率密度関数は
$$
f(y_1,\dots,y_n)=f(y_1\mid y_2,\dots,y_n)f(y_2,\dots,y_n)
$$
であり，さらに 

$$
\begin{align}
f(y_2,\dots,y_n)&=f(y_2\mid y_3,\dots,y_n)f(y_3,\dots,y_n) \\[6pt]
&\,\,\vdots\\[6pt]
f(y_{n-1},y_n)&=f(y_{n-1}\mid y_n)f(y_n) \\[6pt]
\end{align}
$$

これを繰り返すと

$$f(y_1,\dots,y_n)=\Big\{\prod_{k=2}^{n} f(y_{k-1}\mid y_{k},\dots,y_n)\Big\} \times f(y_n)$$

となる.
:::



::: ex 例
本問の場合，連鎖率の総乗部分がどうなるかを確認する．
例として $n=3$ を見る：

$$
\begin{align}
Y_1 &= X_1 \\[4pt]
Y_2 &= Y_1 + X_2 \\[4pt]
Y_3 &= Y_2 + X_3
\end{align}
$$

すなわち，条件として $Y_2, Y_3$ が与えられたときの $Y_1$ は，==$Y_3$ からは増分 $X_3=Y_3-Y_2$ の情報しか得られない==．
しかし $X_1$ と $X_3$ は独立なので，$Y_3$ を追加条件に入れても $Y_1$ の条件付き分布は変わらない．
したがって,
$$
f(y_1|y_2, y_3) = f(y_1|y_2)
$$

:::

::: sum 
一般の $k$ に対しても
$$
f(y_{k-1}\mid y_k,\dots,y_n)=f(y_{k-1}\mid y_k)
$$
が成り立つ．

したがって与式は,
$$
\left\{ \prod_{k=2}^n f_{k-1}(y_{k-1}|y_k) \right\} \times g_n(y_n) = f(y_1, \dots, y_n)

$$
:::

### 変数変換

::: plan
$(y_1,\dots,y_n)\to(x_1,\dots,x_n)$ の変数変換ではヤコビアン $|J|$ を用いて

$$
f(y_1,\dots,y_n)=f(x_1,\dots,x_n)\,|J|
$$

ここで逆変換は,
$$
\begin{align}
&Y_1=X_1,\quad Y_k=Y_{k-1}+X_k\ (k\ge2),\\[6pt]
&\quad X_1=Y_1,\quad X_k=Y_k-Y_{k-1}\ (k\ge2).
\end{align}
$$

:::

::: calc ヤコビアン
ヤコビアン行列 $J=\dfrac{\partial(x_1,\dots,x_n)}{\partial(y_1,\dots,y_n)}$ は
$$
J=
\begin{pmatrix}
1 & 0 & \cdots & 0\\
-1 & 1 & \ddots & \vdots\\
0 & \ddots & \ddots & 0\\
0 & \cdots & -1 & 1
\end{pmatrix}
$$

$J$ は下三角行列で対角成分がすべて $1$ なので
$$
\det J=1\quad\Rightarrow\quad |J|=1
$$

ゆえに
$$
f(y_1,\dots,y_n)
= f(x_1, \dots, x_n)
$$
:::

::: sum

$$
\begin{align}
\left\{ \prod_{k=2}^n f_{k-1}(y_{k-1}|y_k) \right\} \times g_n(y_n) &= f(y_1, \dots, y_n) \\[6pt]
&= f(x_1, \dots, x_n) \\[6pt]
&= f(x_1)f(x_2)\cdots f(x_n) \\[6pt]
&= \prod_{i=1}^{n}f(x_i)
\end{align}
$$

したがって与式は $X_i$の周辺確率密度関数の積で表せる.
:::
